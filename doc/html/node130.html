<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Colors and Colormaps</TITLE>
<META NAME="description" CONTENT="Colors and Colormaps">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="manual.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html3627" HREF="node131.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html3625" HREF="node126.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html3621" HREF="node129.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html3629" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html3630" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3628" HREF="node131.html">XToolKit</A>
<B>Up:</B> <A NAME="tex2html3626" HREF="node126.html">Xwindow Interface</A>
<B> Previous:</B> <A NAME="tex2html3622" HREF="node129.html">Graphic Context</A>
<BR> <P>
<H2><A NAME="SECTION04064000000000000000">Colors and Colormaps</A></H2>
<P>
<A NAME=21848>&#160;</A>
<B>colormap </B> [class]  <PRE><TT> :super B<>object</B>
<P>
:slots 		 (cmapid planes pixels LUT-list)
<P>
</TT></PRE>
<UL><LI> defines an xwindow colormap
and application oriented color look-up tables.
A color is represented by RGB values from 0 through 65535.
Color cells in a color map are addressed by their indices,
which are between 0 and 255 on 8-bit pseudo color display.
</UL>
Here we assume your display device has 8bit pseudo color capability
which allows you to choose 256 colors at the same time.
Basically there are two ways in the use of color maps:
to share the system's default color map or to create private color maps.
If you use the system's default color map, you have to
be careful not to use up all the color cells in the map,
since the map is shared among many processes.
If you use private color maps, you can allocate all 256 color entries
in the map without worrying about other processes,
but  the map has to be explicitly attached to your private windows.
The color map is activated by the window manager
when the mouse pointer is moved somewhere in the window.
<P>
The system's default color map is set up in <TT>x:*color-map*</TT>
which is an instance of the <TT>x:colormap</TT> class
when eusx begins execution.
If you use private color maps, you create instances of <TT>x:colormap</TT>.
These instances 
correspond to the colormap object defined in the x server and are identified by
the <TT>cmapid</TT>  stored in each instance.
<P>
When you use the system's default color map, you can define <EM>read-only</EM>
colors which are shared with other processes or define <EM>read-write</EM>
colors which are private to your EusLisp.
<EM>Read-only</EM> means that you can define arbitrary
color when you allocate the color cell,
but you cannot change it after the allocation.
On the other hand,
<EM>read-write</EM> colors can be altered even after you defined them. 
Shared colors are <EM>read-only</EM> since other processes expect the colors to be
unchanged.
This <EM>read-only</EM> or <EM>read-write</EM> attribute is attached to each
color entry (often referred to as color cell).
<P>
A colormap object defines translation from a color id to a physical
representation that is a triplet of red, green and blue components.
However, these logical color ids cannot be chosen arbitrarily, especially when
you use the the system's default color map. The color id (often referred
to as 'pixel') is an index of a particular color in a color map and Xlib
chooses one of free indices for a shared color when allocation is requested.
Therefore, there is no way, for example, to  guarantee  many levels of
gray colors to be allocated contiguously or to begin from the first (zeroth)
index.
<P>
From the viewpoint of applications, more logical color naming is needed.
For example,
a number of gray levels should be referred to with their brightness as indices.
A ray trace program may wish to assign contiguous indices to a group of colors
of different brightness defined in HLS model.
<P>
To cope with this problem, EusLisp's colormap provides another translation table
called LUT (look-up table). For a logical group of colors, you can define
a LUT and attach a symbolic name to it. More than one LUTs can be defined
in a colormap. 
LUT is an integer vector for the translation of application specific 
logical color indices into physical pixel values that the Xserver can recognize.
<P>
<A NAME=21865>&#160;</A>
<B>:id</B> <EM></EM>[method] 
<UL><LI> returns the cmap id.
</UL>
<A NAME=21875>&#160;</A>
<B>:query</B> <EM>pix </EM>[method] 
<UL><LI> gets RGB values for the specific pixel number.
</UL>
<A NAME=21885>&#160;</A>
<B>:alloc</B> <EM>r g b </EM>[method] 
<UL><LI> this method is the same as <TT>:store nil r g b</TT>.
A new color cell is allocated in this colormap and is assigned with the
specified RGB values.
</UL>
<A NAME=21896>&#160;</A>
<B>:store</B> <EM>pix r g b </EM>[method] 
<UL><LI> sets RGB values to the <EM>pixth color cell.
</UL>
<A NAME=21907>&#160;</A>
<B>:store</B> <EM>pix color-name </EM>[method] 
<UL><LI> <B>:Store</B> is the lowest level method to set a color in a color map.
In the first form, you specify the color with the red, green and blue components
between 0 and 65535 inclusively.  In the second form, you
specify the color by name like &quot;red&quot; or &quot;navy-blue&quot;. If no such color-name is
found, nil is returned.
Pixel is either an integer which is the index in a color map or nil.
If it is integer, the color cell must be read-write-able. 
If it is nil, a shared read-only color cell is allocated.
<TT>:Store</TT> returns the index of the color cell in the color map.
</UL>
<A NAME=21919>&#160;</A>
<B>:store-hls</B> <EM>pix hue lightness saturation </EM>[method] 
<UL><LI> stores the color specified in HLS (Hue, Lightness and Saturation) model
in the <EM>pixth entry  of this colormap.
If <EM>pix is NIL, a shared read-only color cell is allocated.
<TT>:Store-hls</TT> returns the index to the allocated color cell.
</UL>
<A NAME=21932>&#160;</A>
<B>:destroy</B> <EM></EM>[method] 
<UL><LI> destroys this colormap and frees resource.
</UL>
<A NAME=21942>&#160;</A>
<B>:pixel</B> <EM>LUT-name id </EM>[method] 
<UL><LI> looks up in the LUT for the id'th entry and returns its pixel value.
<EM>LUT-name is the name of the look-up-table you defined by <TT>:define-LUT</TT>.
</UL>
<A NAME=21954>&#160;</A>
<B>:allocate-private-colors</B> <EM>num </EM>[method] 
<UL><LI> allocates <EM>num color cells in the private color map.
</UL>
<A NAME=21965>&#160;</A>
<B>:allocate-colors</B> <EM>rgb-list [private] </EM>[method] 
<UL><LI> Each element of <EM>rgb-list is a list of red, green and blue components.
Color cells are allocated for each rgb value and an integer-vector
whose elements are pixel values is returned.
</UL>
<A NAME=21976>&#160;</A>
<B>:define-LUT</B> <EM>LUT-name rgb-list [private] </EM>[method] 
<UL><LI> Colors described in <EM>rgb-list are allocated,
and an LUT is registered by the symbolic name of <EM>LUT-name.
In order to define private color cells, set <EM>private to T.
</UL>
<A NAME=21989>&#160;</A>
<B>:define-gray-scale-LUT</B> <EM>LUT-name levels [private] </EM>[method] 
<UL><LI> allocates <EM>levels of color cells that represent linear 
gray scale colors and returns LUT.
For example, <TT>(send x:*color-map* :define-gray-scale-LUT 'gray8 8)</TT>
allocates eight gray colors in the system's default color map, and
returns an integer vector such as <TT>#i(29 30 31 48 49 50 51 0)</TT>.
Physical pixel values can be inquired by sending the <TT>:pixel</TT> message,
for example, <TT>(send x:*color-map* :pixel 'gray8 2)</TT> returns 31.
</UL>
<A NAME=22004>&#160;</A>
<B>:define-rgb-LUT</B> <EM>LUT-name red green blue [private] </EM>[method] 
<UL><LI> defines an LUT for shrunk RGB representation.
For example, if red=green=blue=2, totally  <IMG  ALIGN=BOTTOM ALT="tex2html_wrap_inline28409" SRC="img69.gif"  >  color cells
are allocated.
</UL>
<A NAME=22015>&#160;</A>
<B>:define-hls-LUT</B> <EM>LUT-name count hue low-brightness
high-brightness saturation [private] </EM>[method] 
<UL><LI> allocates <EM>count colors using the HLS model. Colors of the given <EM>hue (0..360),
<EM>saturation (0..1), and different levels of brightness between
<EM>low-brightness
and <EM>high-brightness</EM> are stored in the color map. A LUT named LUT-name
is also created.
</UL>
<A NAME=22030>&#160;</A>
<B>:define-rainbow-LUT</B> <EM>LUT-name count (hue-start 0) (hue-end 360) (brightness 0.5) (saturation 1.0) (private nil) </EM>[method] 
<UL><LI> allocates <EM>count colors using the HLS model.
Colors of the given <EM>brightness</EM> (0..1),
<EM>saturation</EM> (0..1), and different hues between
<EM>hue-start</EM> and <EM>hue-end</EM>
are stored in the color map.
A LUT named <EM>LUT-name</EM> is also created.
</UL>
<A NAME=22046>&#160;</A>
<B>:LUT-list</B> <EM></EM>[method] 
<UL><LI> returns all LUT list defined in this colormap.
Each entry in the list is a pair of the LUT-name and an integer vector.
</UL>
<A NAME=22056>&#160;</A>
<B>:LUT-names</B> <EM></EM>[method] 
<UL><LI> returns the name list of all LUT in this colormap.
</UL>
<A NAME=22066>&#160;</A>
<B>:LUT</B> <EM>name </EM>[method] 
<UL><LI> returns the integer-vector (LUT) identified by <EM>name.
</UL>
<A NAME=22077>&#160;</A>
<B>:size</B> <EM>LUT-name </EM>[method] 
<UL><LI> returns the length of <EM>LUT
</UL>
<A NAME=22088>&#160;</A>
<B>:planes</B> <EM></EM>[method] 
<UL><LI> returns planes of this colormap.
</UL>
<A NAME=22098>&#160;</A>
<B>:set-window</B> <EM>xwin </EM>[method] 
<UL><LI> associates this colormap to the <EM>xwin window.
This colormap is activated when the cursor enters in <EM>xwin.
</UL>
<A NAME=22110>&#160;</A>
<B>:free</B> <EM>pixel | LUT </EM>[method] 
<UL><LI> frees a specific color cell
addressed by pixel, or all the entries in LUT.
</UL>
<A NAME=22120>&#160;</A>
<B>:init</B> <EM>[cmapid] </EM>[method] 
<UL><LI> initializes this color map with cmap id.
All the LUTs registered are discarded.
</UL>
<A NAME=22130>&#160;</A>
<B>:create</B> <EM>&amp;key (planes 0) (colors 1) (visual *visual*) (contiguous nil) </EM>[method] 
<UL><LI> creates a new color map object.
</UL>
<A NAME=22141>&#160;</A>
<B>XColor </B> [class]  <PRE><TT> :super B<>cstruct</B>
<P>
:slots 		 ((pixel        :integer)
<P>
		  (red          :short)
<P>
		  (green        :short)
<P>
		  (blue         :short)
<P>
		  (flags        :byte)
<P>
		  (pad          :byte))
<P>
</TT></PRE>
<UL><LI> 
defines a color in the RGB model.
Use <B>setf</B> to assign value to each slots.
The RGB values are sign extended and the greatest value is
represented as -1.
</UL>
<A NAME=22159>&#160;</A>
<B>:red</B> <EM></EM>[method] 
<UL><LI> returns the red value of this XColor.
</UL>
<A NAME=22169>&#160;</A>
<B>:blue</B> <EM></EM>[method] 
<UL><LI> returns the blue value of this XColor.
</UL>
<A NAME=22179>&#160;</A>
<B>:green</B> <EM></EM>[method] 
<UL><LI> returns the green value of this XColor.
</UL>
<A NAME=22189>&#160;</A>
<B>:rgb</B> <EM></EM>[method] 
<UL><LI> returns the list of red, green and blue values
of this XColor.
</UL>
<A NAME=22199>&#160;</A>
<B>:init</B> <EM>pix R G B &amp;optional (f 7) </EM>[method] 
<UL><LI> initializes XColor.
</UL>
<A NAME=22209>&#160;</A>
<B>find-visual</B> <EM>type depth &amp;optional (screen 0) </EM>[function] 
<UL><LI> finds the visual-ID of the specified <EM>type and <EM>depth.
<EM>Type should be either <TT>:StaticGray, :GrayScale,
:StaticColor, :pseudoColor, :TrueColor</TT> or <TT>:DirectColor</TT>.
Usually the <EM>depth should be either 1, 8 or 24.
</UL>
<P>
</EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM><HR><A NAME="tex2html3627" HREF="node131.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html3625" HREF="node126.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html3621" HREF="node129.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html3629" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html3630" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3628" HREF="node131.html">XToolKit</A>
<B>Up:</B> <A NAME="tex2html3626" HREF="node126.html">Xwindow Interface</A>
<B> Previous:</B> <A NAME="tex2html3622" HREF="node129.html">Graphic Context</A>
<P><ADDRESS>
<I>Hirofumi Nakagaki <BR>
Tue Mar 19 19:45:39 JST 1996</I>
</ADDRESS>
</BODY>
</HTML>
