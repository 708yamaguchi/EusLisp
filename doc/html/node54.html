<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Reader</TITLE>
<META NAME="description" CONTENT="Reader">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="manual.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html2582" HREF="node55.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html2580" HREF="node52.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html2574" HREF="node53.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html2584" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html2585" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html2583" HREF="node55.html">Printer</A>
<B>Up:</B> <A NAME="tex2html2581" HREF="node52.html">Streams and Input/Output</A>
<B> Previous:</B> <A NAME="tex2html2575" HREF="node53.html">Streams</A>
<BR> <P>
<H2><A NAME="SECTION03082000000000000000">Reader</A></H2>
<P>
Reader's global variables:
<P>
<DL ><DT><STRONG>*read-base*</STRONG>
<DD> number base to be read; default is decimal ten
<DT><STRONG>*readtable*</STRONG>
<DD> current readtable which determines reader syntax
<P>
 </DL>
<P>
Reader's default macro characters:
<PRE><TT> <B>(</B> read list
<P>
<B>&quot;</B> 		  read string
<P>
<B>'</B> 		  read quoted expression
<P>
<B>#</B> 		  dispatch macro
<P>
<B>;</B> 		  comment until end of line
<P>
<B>`</B> 		  back-quote
<P>
<B>,</B> 		  list-time eval
<P>
<B>@</B> 		  append
<P>
<B>%</B> 		  read C-like mathematical forms
<P>
</TT></PRE>
<P>
Escape characters:
<P>
<PRE><TT> <B> <IMG  ALIGN=MIDDLE ALT="tex2html_wrap_inline28176" SRC="img25.gif"  > </B> single character escape
<P>
<B>|...|</B> 		  multiple character escape
<P>
</TT></PRE>
<P>
When an unescaped symbol is read,
all the constituent characters are converted to upcase by default,
and upcase-character symbol is stored internally.
For example, 'abc and 'ABC are regarded as the same symbol.
Escape is necessary to distinguish between them.
'|ABC|, 'ABC and 'abc are identical,
while '|abc| and 'abc are different symbols.
By default, even if you enter a symbol with upcase letters,
When symbols are printed,
EusLisp's printer converts them into lowercase from
internal upcase representation.
This conversion is
suppressed by setting <B>*print-case*</B> to <B>:UPCASE</B>.
<P>
Note that 10. is read as integer 10, not floating 10.0.
Since ':' is reserved for package marker, it must be escaped
when used as a constituent of a symbol, like '|<I>g</I>:<I>pcube</I>|.
This restriction is imposed not by the syntax of the character ':',
but by the attribute which determines the alphabetical order and the meaning of
the letter.
The attributes of characters are hardwired in the reader.
Thus, although you may change the syntax of a certain character by
creating a new readtable by <B>copy-readtable</B> and
resetting the syntactic meaning for the character by <B>set-syntax-from-char</B>,
you cannot change its attribute anyway. 
In other words, digits are always digits, alphabets are alphabets,
and we cannot use letters like '#$%@' to represent numbers.
<P>
<B>%</B> is an extended read-macro character specific to EusLisp.
Preceding % to a mathematical formula written in infix notation,
the formula is converted to lisp's prefix form. For an instance,
<TT>%(1 + 2 * 3 / 4.0)</TT> is transformed to
<TT>(+ 1 (/ (* 2 3) 4.0))</TT> and <TT>2.5</TT> is resulted.
C-like function calls and array references are converted to lisp forms, too,
thus, <TT>%(sin(x) + a[1])</TT>
is evaluated to <TT>(+ (sin x) (aref a 1))</TT>.
Functions having more than one arguments and arrays of more than two
dimeisions are notated as <TT>func(a b c ...)</TT> and <TT>ary[1 2 3 ...]</TT>,
not <TT>func(a,b,c)</TT> nor <TT>ary[1][2][3]</TT>.
Relative expressions and assignments are also properly handled, so,
<TT>%(a &lt; b)</TT> is converted to <TT>(&lt; a b)</TT>,
and <TT>%(a[0] = b[0] * c[0])</TT> is to
<TT>(setf (aref b 0) (* (aref b 0) (aref c 0)))</TT>.
A simple optimization is performed to reduce duplicated function calls and
array references.
<TT>%(sin(x) + cos(x) / sin(x))</TT> is converted into 
<TT>(let* ((temp (sin x))) (+ temp (/ (cos x) temp)))</TT>.
<P>
Dispatch macros are  preceeded by the <code>#</code> character.
A number (integer) argument can be given between <code>#</code> and a dispatch macro
character.
This means that any digits (0 .. 9) cannot be defined as dispatch
macro characters.
Reader's standard dispatch macro characters follow:
<DL ><DT><STRONG><TT>#nA(..)</TT></STRONG>
<DD> array
<DT><STRONG><TT>#B</TT></STRONG>
<DD> binary number
<DT><STRONG><TT>#D</TT></STRONG>
<DD> degree to radian conversion; #D180 = 3.14
<DT><STRONG><TT>#F(...)</TT></STRONG>
<DD> floatvector
<DT><STRONG><TT>#nF((..))</TT></STRONG>
<DD> float array; #2F((..) (..)) is matrix
<DT><STRONG><TT>#I(...)</TT></STRONG>
<DD> integer-vector
<DT><STRONG><TT>#nI((...))</TT></STRONG>
<DD> integer array
<DT><STRONG><TT>#J(...)</TT></STRONG>
<DD> general object #J(myclass ....); obsolete
<DT><STRONG><TT>#O</TT></STRONG>
<DD> octal number
<DT><STRONG><TT>#P</TT></STRONG>
<DD> pathname
<DT><STRONG><TT>#R</TT></STRONG>
<DD> radian to degree conversion; #R3.14 = 180.0
<DT><STRONG><TT>#S(classname slotname1 val1 slotname2 val2 ...)</TT></STRONG>
<DD> structure (any object)
<DT><STRONG><TT>#V(...)</TT></STRONG>
<DD>  vector #V(vectorclass ...)
<DT><STRONG><TT>#X</TT></STRONG>
<DD> hexadecimal number
<DT><STRONG><TT>#(...)</TT></STRONG>
<DD> vector
<DT><STRONG><TT>#n#</TT></STRONG>
<DD> label reference
<DT><STRONG><TT>#n=</TT></STRONG>
<DD> label definition	
<DT><STRONG><TT>#'</TT></STRONG>
<DD> FUNCTION; compiled-code or lambda-closure
<DT><STRONG><TT># <IMG  ALIGN=MIDDLE ALT="tex2html_wrap_inline28176" SRC="img25.gif"  > </TT></STRONG>
<DD> character
<DT><STRONG><TT>#,</TT></STRONG>
<DD> read-time evaluation
<DT><STRONG><TT>#+</TT></STRONG>
<DD> conditional read (positive)
<DT><STRONG><TT>#-</TT></STRONG>
<DD> conditional read (negative)
<DT><STRONG><TT>#*</TT></STRONG>
<DD> bit vector
<DT><STRONG><TT>#:</TT></STRONG>
<DD> uninterned symbol
<DT><STRONG><TT>#|...|#</TT></STRONG>
<DD> comment; can be nested
<P>
 </DL>
<P>
Some reader functions have <EM>eof-error-p, eof-value</EM> and
<EM>recursive-p</EM> parameters.
The first two parameters control the behavior when the reader encounters
with end-of-file.
The default of <EM>eof-error-p</EM> is t, which causes an error at eof.
If you want to know the occurrence of eof and don't want the system's
error-handler to snatch control, specify nil to <EM>eof-error-p</EM>.
Thus, when an eof appears during reading, the reader returns
the <EM>eof-value</EM> instead of entering an error loop.
<EM>Eof-value</EM> is defaulted to nil.
So, you cannot know if nil is actually read, or eof appears.
To distinguish them, give a value which can never appear in the stream.
Use <B>cons</B> or <B>gensym</B> to make such unique data object.
<P>
<EM>Recursive-p</EM> is often used in read-macro functions,
which call reader recursively.
Non-nil value of <EM>recursive-p</EM> tells the reader that the read operation
has been started somewhere else and it should not reset
the internal table for reading forms labeled by <TT>#n=</TT> and <TT>#n#</TT>.
<P>
<A NAME=8095>&#160;</A>
<B>read</B> <EM>&amp;optional stream (eof-error-p t) (eof-value nil) recursive-p </EM>[function] 
<UL><LI> reads one S-expression.
</UL>
<A NAME=8105>&#160;</A>
<B>read-delimited-list</B> <EM>delim-char &amp;optional stream recursive-p </EM>[function] 
<UL><LI> reads s-expression which is delimited by <EM>delim-char.
This is useful to read comma-separated list, or to read a sequence
terminated by a special character like <TT># <IMG  ALIGN=MIDDLE ALT="tex2html_wrap_inline28176" SRC="img25.gif"  > ]</TT>.
</UL>
<A NAME=8117>&#160;</A>
<B>read-line</B> <EM>&amp;optional stream (eof-error-p t) (eof-value nil) </EM>[function] 
<UL><LI> reads a line which is terminated by a <TT># <IMG  ALIGN=MIDDLE ALT="tex2html_wrap_inline28176" SRC="img25.gif"  > newline</TT>.
The string returned does not contain the last newline character.
</UL>
<A NAME=8128>&#160;</A>
<B>read-char</B> <EM>&amp;optional stream (eof-error-p t) (eof-value nil) </EM>[function] 
<UL><LI> reads one character and returns its integer representation.
</UL>
<A NAME=8138>&#160;</A>
<B>read-from-string</B> <EM>string &amp;optional (eof-error-p t) (eof-value nil) </EM>[function] 
<UL><LI> reads one s-expression from <EM>string.
Only the first s-expression can be read.
If successive read operations need to be performed on a string
containing more than one expression,
use string-stream made by <A NAME=8150>&#160;</A><B>m</B>ake-string-input-stream.
</UL>
<A NAME=8152>&#160;</A>
<B>unread-char</B> <EM>char &amp;optional stream </EM>[function] 
<UL><LI> puts the <EM>char back to the <EM>stream.
More than one characters cannot be put back successively.
</UL>
<A NAME=8164>&#160;</A>
<B>peek-char</B> <EM>&amp;optional stream (eof-error-p t) (eof-value nil) </EM>[function] 
<UL><LI> reads a character from the <EM>stream without removing it from the buffer
of the <EM>stream.
This is equivalent to a <EM>read-char followed by a <EM>unread-char</EM>.
</UL>
<A NAME=8178>&#160;</A>
<B>y-or-n-p</B> <EM>&amp;optional format-string &amp;rest args </EM>[function] 
<UL><LI> prints <EM>format-string and <EM>args</EM> on your terminal,
and asks ``y-or-n''.
Repeat query until your response begins with either of ``y'' or ``n'',
and returns T or NIL. Case does not matter.
</UL>
<A NAME=8190>&#160;</A>
<B>yes-or-no-p</B> <EM>&amp;optional stream </EM>[function] 
<UL><LI> prints <EM>format-string and <EM>args</EM> on your terminal,
and asks ``yes-or-no''.
Repeat query until your response is either of ``yes'' or ``no'',
and returns T or NIL.
Case does not matter.
</UL>
In the readtable manipulating functions, the default value of readtable
is the value of the global variable <B>*readtable*</B>.
<P>
<A NAME=8202>&#160;</A>
<B>readtable-p</B> <EM>x </EM>[function] 
<UL><LI> T if <EM>x is an readtable.
</UL>
<A NAME=8213>&#160;</A>
<B>copy-readtable</B> <EM>&amp;optional from-readtable to-readtable </EM>[function] 
<UL><LI> If no <EM>to-readtable is specified, a new one is created.
All the information in <EM>from-readtable</EM> is transferd to <EM>to-readtable</EM>.
The information included is, syntax table, read-macro table and
dispatch-macro table, each of which has 256 elements.
</UL>
<A NAME=8226>&#160;</A>
<B>set-syntax-from-char</B> <EM>from-char to-char [from-readtable to-readtable] </EM>[function] 
<UL><LI> copies syntax and read-macro definition of <EM>from-char in
<EM>from-readtable</EM> to that of <EM>to-char</EM> in <EM>to-readtable</EM>.
</UL>
<A NAME=8240>&#160;</A>
<B>set-macro-character</B> <EM>char func [non-teminating-p readtable] </EM>[function] 
<UL><LI> defines <EM>func as the read-macro function for <EM>char</EM>.
</UL>
<A NAME=8252>&#160;</A>
<B>get-macro-character</B> <EM>char [readtable] </EM>[function] 
<UL><LI> returns the read-macro function for <EM>char.
</UL>
<A NAME=8263>&#160;</A>
<B>set-dispatch-macro-character</B> <EM>dispchar char func [readtable] </EM>[function] 
<UL><LI> defines <EM>func as the dispatch read-macro function for 
the combination of <EM>dispchar</EM> and <EM>char</EM>.
</UL>
<A NAME=8276>&#160;</A>
<B>get-dispatch-macro-character</B> <EM>dispchar char [readtable] </EM>[function] 
<UL><LI> returns the dispatch read-macro function for 
the combination of <EM>dispchar and <EM>char</EM>.
</UL>
<P>
</EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM></EM><HR><A NAME="tex2html2582" HREF="node55.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html2580" HREF="node52.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html2574" HREF="node53.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html2584" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html2585" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html2583" HREF="node55.html">Printer</A>
<B>Up:</B> <A NAME="tex2html2581" HREF="node52.html">Streams and Input/Output</A>
<B> Previous:</B> <A NAME="tex2html2575" HREF="node53.html">Streams</A>
<P><ADDRESS>
<I>Hirofumi Nakagaki <BR>
Tue Mar 19 19:45:39 JST 1996</I>
</ADDRESS>
</BODY>
</HTML>
