<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>
Multi-Joint Manipulators
</TITLE>
<META NAME="description" CONTENT="
Multi-Joint Manipulators
">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="manual.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html3866" HREF="node150.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html3864" HREF="node147.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html3860" HREF="node148.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html3868" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html3869" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3867" HREF="node150.html"> MARS: A Multiple </A>
<B>Up:</B> <A NAME="tex2html3865" HREF="node147.html">Manipulators</A>
<B> Previous:</B> <A NAME="tex2html3861" HREF="node148.html">
Rotational Joint
</A>
<BR> <P>
<H2><A NAME="SECTION04092000000000000000">
Multi-Joint Manipulators
</A></H2>
<P>
A model of a manipulator is described by <B>manipulator</B>. 
<B>defmanipulator</B> macro below creates an instance of <B>manipulator</B>.
<P>
<TT><BLOCKQUOTE> <PRE><TT> (defmanipulator <I>manipulator-name</I>
<P>
:class I<>manipulator-class</I>
<P>
		 :base 		 <I>base-joint</I>
<P>
		 :joints 		  <I>list-of-all-joints</I>
<P>
		 :hand 		 <I>handjoint</I>
<P>
		 :left-finger 		 <I>left-finger</I>
<P>
		 :right-finger 		 <I>right-finger</I>
<P>
		 :handcoords 		 <I>trans-from-hand-to-armsolcoords</I>
<P>
		 :toolcoords 		 <I>trans-from-armsolcoords-to-toolcoords</I>
<P>
		 :open-direction 		 <I>finger-open-direction</I>
<P>
		 :right-handed  		 <I>righty-or-lefty</I>
<P>
		        )
<P>
</TT></PRE></BLOCKQUOTE> </TT>
<A NAME=26449>&#160;</A>
<B>rotational-joint </B> [class]  <PRE><TT> :super B<>body</B>
<P>
:slots 		 (axis offset high-limit low-limit)
<P>
</PRE>
<UL><LI> 
describes each rotational joint of a 6 D.O.Fs manipulator.
</UL>
<A NAME=26467>&#160;</A>
<B>manipulator </B> [class]  <PRE><TT> :super B<>cascaded-coords</B>
<P>
:slots 		 (base baseinverse joint
<P>
		 angles right-handed hand handcoords right-finger left-finger
<P>
		openvec max-span toolcoords toolinverse armsolcoords
<P>
		 toolinverse armsocoords approach grasp affix)
<P>
</TT></PRE>
<UL><LI> manages kinematics of a manipulator from base to hand.
</UL>
<A NAME=26484>&#160;</A>
<B>:newcoords</B> <EM>newrot &amp;optional newpos </EM></TT>[method] 
<UL><LI> updates the coords with newrot and newpos if new joint angles are within the 
limit.
<P>
</UL>
<A NAME=26494>&#160;</A>
<B>:armsolcoords </B> <EM></EM></TT>[method] 
<UL><LI> computes and makes transformation (an instance coords) 
between the coords of the 
base and those of the hand.
<P>
</UL>
<A NAME=26504>&#160;</A>
<B>:tool</B> <EM>&amp;rest msg </EM></TT>[method] 
<UL><LI> modifies or gets toolcoords.
<P>
</UL>
<A NAME=26514>&#160;</A>
<B>:set-tool</B> <EM>newtool &amp;optional offset copy </EM></TT>[method] 
<UL><LI> sets new toolcoords.
<P>
</UL>
<A NAME=26524>&#160;</A>
<B>:reset-tool </B> <EM></EM></TT>[method] 
<UL><LI> forces this coords to be default-toolcoords.
<P>
</UL>
<A NAME=26534>&#160;</A>
<B>:worldcoords </B> <EM></EM></TT>[method] 
<UL><LI> computes the position vector, the rotation matrix, and the coordinates of the 
toolcoords represented in the world coordinates.
<P>
</UL>
<A NAME=26544>&#160;</A>
<B>:set-coords </B> <EM></EM></TT>[method] 
<UL><LI> forces setting coords according to the forward kinematic solution.
<P>
</UL>
<A NAME=26554>&#160;</A>
<B>:config </B> <EM>&amp;optional (a newangles) </EM></TT>[method] 
<UL><LI> sets joint angles of the manipulator.
<P>
</UL>
<A NAME=26564>&#160;</A>
<B>:park </B> <EM></EM></TT>[method] 
<UL><LI> forces all the joint angles to be zero.
<P>
</UL>
<A NAME=26574>&#160;</A>
<B>:hand</B> <EM>&amp;optional (h nil) </EM></TT>[method] 
<UL><LI> sets or returns the object of its hand.
<P>
</UL>
<A NAME=26584>&#160;</A>
<B>:handcoords</B> <EM></EM></TT>[method] 
<UL><LI> computes the position vector, the rotation matrix, and the coordinates of the 
handcoords represented in the world coordinates.
<P>
</UL>
<A NAME=26594>&#160;</A>
<B>:span</B> <EM></EM></TT>[method] 
<UL><LI> returns the current distance between fingers.
<P>
</UL>
<A NAME=26604>&#160;</A>
<B>:open-fingers</B> <EM>s &amp;optional abs &amp;aux (current (send self :span)) </EM></TT>[method] 
<UL><LI> moves fingers relatively or absolutely.
<P>
</UL>
<A NAME=26614>&#160;</A>
<B>:close-fingers</B> <EM></EM></TT>[method] 
<UL><LI> closes fingers completely.
<P>
</UL>
<A NAME=26624>&#160;</A>
<B>:angles</B> <EM>&amp;optional flag </EM></TT>[method] 
<UL><LI> returns the list of current joint angles.
<P>
</UL>
<A NAME=26634>&#160;</A>
<B>:get-approach </B> <EM></EM></TT>[method] 
<UL><LI> returns the object to which the hand is approaching.
<P>
</UL>
<A NAME=26644>&#160;</A>
<B>:set-approach </B> <EM>a </EM></TT>[method] 
<UL><LI> sets <I>a</I> as the object to which the hand will approach.
<P>
</UL>
<A NAME=26655>&#160;</A>
<B>:get-grasp</B> <EM></EM></TT>[method] 
<UL><LI> (:get-grasp () grasp-config)
<P>
</UL>
<A NAME=26665>&#160;</A>
<B>:set-grasp</B> <EM>g </EM></TT>[method] 
<UL><LI> sets <I>g</I> as the object which the hand will grasp.
<P>
</UL>
<A NAME=26676>&#160;</A>
<B>:get-affix</B> <EM></EM></TT>[method] 
<UL><LI> returns the object which the hand grasps.
<P>
</UL>
<A NAME=26686>&#160;</A>
<B>:affix</B> <EM>&amp;optional (grasp) </EM></TT>[method] 
<UL><LI> sets <B>affixed-object</B> <B>grasp</B>.
<B>grasp</B> is associated to the handcoords as a descendant.
<P>
</UL>
<A NAME=26699>&#160;</A>
<B>:unfix</B> <EM>&amp;optional (margin 10.0) </EM></TT>[method] 
<UL><LI> sets <B>affixed-object</B> nil.
<B>grasp</B> is dissociated (removed) from the descendants list of the handcoords.
<P>
</UL>
<A NAME=26711>&#160;</A>
<P> <IMG  ALIGN=BOTTOM ALT="emtabbing26712" SRC="img98.gif"  > <P>
<UL><LI> 
creates and initializes a new manipulator object.
<P>
</UL>
<B>manipulator</B> manages the linkage of the coords of 
<B>base、joints(J1...J6)、handcoords、toolcoords</B>. 
<B>manipulator</B> has <B>cascaded-coords</B> as super-class. 
<B>manipulator</B> is connected with <B>base</B> which is <B>cascaded-coords</B>
(or subclasses of <B>body</B>). <B>manipulator</B> manages the transformation from 
the base frame to the toolcoords. Messages sent to <B>manipulator</B> 
(i.e. <B>:translate, :locate, :rotate, :orient, :transform</B> etc.) effect 
the end effector of the manipulator. If WRT parameter is set one of keywords 
(i.e. :local, :parent, :world or an instance of coordinates) in this message, 
the end-effector  moves with respect to the WRT parameter. 
In the next program <B>eta3</B> is a instance of <B>manipulator</B>.
<P>
<PRE>　(send eta3 :translate #f(0 0 -100))        ;put back the end-effector by 10cm
　(send eta3 :translate #f(0 0 -100) :world) ;move down the end-effector by 10cm
　(send eta3 :translate #f(0 0 -100)
             (manipulator-base eta3))  ;move down the end-effector with respect 
                                       ;to the coords of the base by 10cm</PRE>
<P>
When <B>manipulator</B> receives these messages, it calculates the arm solution 
and 6 joint angles are determined. Generally, more solutions than one exist.
In that case, one appropriate solution is chosen of them according to the 
criteria (i.e. the distinction between <B>right-handed</B> and <B>left-handed</B>,
and the consistency with current joint angles). If there is no solution for 
a given configuration or the calculated joint angles exceed its limits, 
<B>manipulator</B> does not move and it gives a warning.
<P>
Arm-solution method <B>:armsol</B> must be defined for respective manipulator 
classes which correspond to real manipulators. This method calculates the 
transformation between the base-coords and the hand-coords. Thus this allow us 
to put a manipulator wherever with respect to the world-coords. The arm solution 
is independent of the <B>base, toolcoords</B>.
<P>
Fig. <A HREF="node149.html#JointCoords">20</A> shows the relation between coordinate systems 
(<B>base, J1, J2,..., handcoords</B> and <B>toolcoords</B>). <I>T</I> and other 
transformations are calculated as follows.
<P>
 <IMG  ALIGN=MIDDLE ALT="tex2html_wrap_inline28426" SRC="img99.gif"  > 
<P>
where <I>T</I> is the transformation between the world-coords and the toolcoords.
<P>
<P><A NAME="26416">&#160;</A> <IMG  ALIGN=BOTTOM ALT="figure26393" SRC="img100.gif"  > <BR>
<STRONG>Figure 20:</STRONG> <A NAME="JointCoords">&#160;</A>
relation between coordinate systems in a manipulator<BR>
<P>
<P>
Each joint has a geometric model represented by Breps (Boundary Representation).
The coordinates of the vertices and the equations of the planes are not always 
current ones. Messages sent to <B>manipulator</B> for translation or rotation only
update the coordinate systems, these do not update the coordinates of the 
vertices. This is why we can reduce the calculation time when translation or 
rotation occurs successively. If <B>:worldcoords</B> message is sent to 
<B>manipulator</B>, it updates the data such as the coordinates of the vertices.
<P>
Mainly toolcoords are used for specify the motion of a manipulator in 
this <B>manipulator</B>. There is a method (<B>:config</B>) for specifying the 
configuration of the manipulator by joint angles. The arguments are a 
float-vector whose elements are 6.
<P>
<PRE>　 (send eta3 :config (float-vector pi/2 pi/2 0 1 0 1))</PRE>
<P>
<B>:config</B> rotates joints of the manipulator if the joint angles are in the 
limit. As a result, the coordinates which <B>manipulator</B> manages and the 
current toolcoords which given joint angles determines become inconsistent.
<B>:set-coords</B> message must be sent if you need consistency. <B>:set-coords</B>
calculates a forward kinematic solution and calculates the arm solution using the 
forward kinematic solution.
<P>
Example: create the manipulator model (ETA3) and draw this on a Xwindow system.
<PRE>;EusLisp 7.27 with Xlib created on Thu Sep 17 14:33:30 1992
(load &quot;view.l&quot;)                                ;open a window
(load &quot;/usr/local/eus/robot/eta3/eta3build.l&quot;) ;create the model of ETA3
(send *viewing* :look #f(2000 2000 2000))      ;change the viewpoint
(send-all (eta3arm-components eta3) :color 1)  ;change the color of lines
(send eta3 :config (float-vector 0 (/ -Pi 4.0) Pi/2 0 (/ -Pi 4.0) 0 ))
					       ;set joint angles of ETA3
(send eta3 :set-coords)                        ;refer to the above explanation
(draw eta3)                                    ;draw ETA3</PRE>
<P>
<HR><A NAME="tex2html3866" HREF="node150.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html3864" HREF="node147.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html3860" HREF="node148.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html3868" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html3869" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3867" HREF="node150.html"> MARS: A Multiple </A>
<B>Up:</B> <A NAME="tex2html3865" HREF="node147.html">Manipulators</A>
<B> Previous:</B> <A NAME="tex2html3861" HREF="node148.html">
Rotational Joint
</A>
<P><ADDRESS>
<I>Hirofumi Nakagaki <BR>
Tue Mar 19 19:45:39 JST 1996</I>
</ADDRESS>
</BODY>
</HTML>
