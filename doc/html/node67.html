<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Program Loading</TITLE>
<META NAME="description" CONTENT="Program Loading">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="manual.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html2744" HREF="node68.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html2742" HREF="node63.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html2736" HREF="node66.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html2746" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html2747" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html2745" HREF="node68.html">Debugging Aid</A>
<B>Up:</B> <A NAME="tex2html2743" HREF="node63.html">Evaluation</A>
<B> Previous:</B> <A NAME="tex2html2737" HREF="node66.html">Compilation</A>
<BR> <P>
<H2><A NAME="SECTION03094000000000000000">Program Loading</A></H2>
<P>
<A NAME=9907>&#160;</A>
<P> <IMG  ALIGN=BOTTOM ALT="emtabbing9908" SRC="img33.gif"  > <P>
<UL><LI> 
<B>Load</B> is the function
to read either a source file or an compiled object file into EusLisp.
If the file specified by <EM>fname</EM> exists, it is loaded.
Whether the file is source or binary is automatically checked by seeing
its magic number.
If the file does not exist but a file with the file type '.o' exists,
the file is loaded as an object file.
Else if a file with the '.l' suffix is found, it is loaded as a 
source program.
If the file name is not specified in the absolute path by prefixing
the name with a slash &quot;/&quot;,
<B>load</B> searches for the file in the directories specified
by the <B>*load-path*</B> global variable.
For example, if <TT>*load-path*</TT> is <TT>(&quot;/user/eus/&quot; &quot;/usr/lisp/&quot;)</TT>,
and <TT>&quot;llib/math&quot;</TT> is given as <EM>fname</EM>,
<B>load</B> tries to find <TT>&quot;/user/eus/llib/math.o&quot;, 
&quot;/usr/lisp/llib/math.o&quot;, &quot;/user/eus/llib/math.l&quot;</TT> and
<TT>&quot;/usr/lisp/llib/math.l&quot;</TT>
in this order.
If no appropriate file could be found, an error is reported.
<P>
<I>:entry</I> option specifies the entry address to initialize the load module.
For example, <TT>:entry &quot;_myfunc&quot;</TT> option means that the execution begins
at <TT>_myfunc</TT>.
Default entry is the basename of the file loaded as described
in the section <A HREF="node66.html#compiler">10.3</A>.
Library module names can be specified in <B>:ld-option</B> option string.
For example, in order to link a module which uses suncore libraries,
<B>:ld-option</B> <TT>&quot;-lsuncore -lsunwindow -lpixrect -lm -lc&quot;</TT>
should be given. 
On non Solaris systems, ld runs twice when libraries are included;
once to determine the size of the linked module,
and again to link them actually with a proper memory allocation.
<P>
<B>:symbol-input</B> and <B>:symbol-output</B> options are used to 
solve references from one object module to another or to avoid duplicated
loading of libraries.
Suppose you have two object modules A and B which has reference to symbols
defined in A. You first load the module A specifying <TT>:symbol-output =
&quot;a.out&quot;</TT>.
Symbol information generated by this linking is written to <TT>a.out</TT>.
In order to load the module B, you have to specify
<TT>:symbol-input = &quot;a.out&quot;</TT> to solve the references from B to A.
</UL>
On Solaris2 OS, the loading of compiled code is done by calling <EM>dlopen</EM>
in the dynamic loader library.
The use of <EM>dlopen</EM> is restricted to shared objects which is compiled
position independently with &quot;-K pic&quot; option.
Also,  since <EM>dlopen</EM> cannot open the same file twice,
load first does <EM>dlclose</EM> on the file already loaded.
<P>
<A NAME=9942>&#160;</A>
<B>load-files</B> <EM>&amp;rest files </EM>[function] 
<UL><LI> loads <EM>files successively
with setting <TT>:verbose</TT> to T.
</UL>
<A NAME=9954>&#160;</A>
<B>*modules*</B> <EM></EM>[variable] 
<UL><LI> holds a list of names of the modules that
have been loaded so far.
</UL>
<A NAME=9964>&#160;</A>
<B>provide</B> <EM>module-name </EM>[function] 
<UL><LI> adds <EM>module-name in <TT>*modules*</TT>
as the name of the module being loaded. <EM>module-name should be
a symbol or a string. Calls to <B>require</B> should appear at the beginning
of files that compose a complete modules.
</UL>
<A NAME=9978>&#160;</A>
<B>require</B> <EM>module-name &amp;optional file </EM>[function] 
<UL><LI> loads <EM>file unless <EM>module-name</EM> is found in <TT>*modules*</TT>.
<B>provide</B> and <B>require</B> control dependency among modules and
are used to avoid duplicated loading of basic modules.
Suppose you have one basic module named &quot;A&quot; and two application modules
named &quot;B&quot; and &quot;C&quot; which are independent from each other but rely on 
&quot;A&quot; module. At the beginning of each file, module name is declared
by <B>provide</B>. Since &quot;A&quot; module does not depend on any other modules
it does not <B>require</B> anything. 
<TT>(require &quot;A&quot; &quot;a.o&quot;)</TT> follows  calls to <B>provide</B> in &quot;B&quot; and &quot;C&quot;.
If you load &quot;B&quot; (more precisely, &quot;b.o&quot;), &quot;a.o&quot; is also loaded since
it is found in <TT>*modules*</TT> and
two module names &quot;A&quot; and &quot;B&quot; are added to <TT>*modules*</TT>.
Then if you load &quot;C&quot;, &quot;A&quot; module is not loaded and &quot;C&quot; is added to
<TT>*modules*</TT>.
</UL>
<A NAME=10000>&#160;</A>
<P> <IMG  ALIGN=BOTTOM ALT="emtabbing10001" SRC="img34.gif"  > <P>
<UL><LI> link-load a binary file.
</UL>
<A NAME=10011>&#160;</A>
<B>system:txtload</B> <EM>fname </EM>[function] 
<UL><LI> </UL>
<P>
</EM></EM></EM></EM><HR><A NAME="tex2html2744" HREF="node68.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html2742" HREF="node63.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html2736" HREF="node66.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html2746" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html2747" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html2745" HREF="node68.html">Debugging Aid</A>
<B>Up:</B> <A NAME="tex2html2743" HREF="node63.html">Evaluation</A>
<B> Previous:</B> <A NAME="tex2html2737" HREF="node66.html">Compilation</A>
<P><ADDRESS>
<I>Hirofumi Nakagaki <BR>
Tue Mar 19 19:45:39 JST 1996</I>
</ADDRESS>
</BODY>
</HTML>
