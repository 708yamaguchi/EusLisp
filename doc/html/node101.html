<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Thread creation</TITLE>
<META NAME="description" CONTENT="Thread creation">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="manual.css">
</HEAD>
<BODY LANG="EN">
 <A NAME="tex2html3265" HREF="node102.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html3263" HREF="node88.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html3257" HREF="node100.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html3267" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html3268" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3266" HREF="node102.html">Synchronization</A>
<B>Up:</B> <A NAME="tex2html3264" HREF="node88.html">Multithread</A>
<B> Previous:</B> <A NAME="tex2html3258" HREF="node100.html">Measured Parallel Gains</A>
<BR> <P>
<H2><A NAME="SECTION04024000000000000000">Thread creation</A></H2>
<P>
A thread is a unit for assigning computation, usually evaluation
of a lisp form.
Threads in EusLisp are represented by instances of
the <B>thread</B> class.
This object is actually a control port of a thread 
to pass arguments and result, and let it start evaluation,
rather than the thread's entity representing the context.
<P>
<A NAME=12943>&#160;</A>
<B>sys:make-thread</B> <EM>num &amp;optional (lsize 32*1024) (csize lsize) </EM>[function] 
<UL><LI> creates <EM>num threads with <EM>lsize</EM> words of Lisp stack
and <EM>csize</EM> words of C stack, and put them in the system's
thread pool.
All the threads in the thread pool is bound to sys:*threads*,
which is extended each time <B>make-thread</B> is called.
By the <B>thread</B> function, a computation is assigned to one
of free threads in the thread pool.
Therefore it is not a good idea to change stack sizes
from thread to thread,
since you cannot control which thread is assigned to a specific
computation.
</UL>
<A NAME=12958>&#160;</A>
<B>sys:*threads*</B> <EM></EM>[variable] 
<UL><LI> returns the list of all the threads created by <B>make-threads</B>.
</UL>
<A NAME=12969>&#160;</A>
<B>sys::free-threads</B> <EM></EM>[function] 
<UL><LI> returns the list of threads in the
free thread pool.
If the result is NIL, new commitment of a task to a thread
is blocked until any currently running threads finish evaluation
or new threads are created by <B>make-thread</B> in the free thread pool.
</UL>
<A NAME=12980>&#160;</A>
<B>sys:thread</B> <EM>func &amp;rest args </EM>[function] 
<UL><LI> picks up one free thread from the thread pool, and assigns it
for evaluation of <EM>(func . args).
<B>Sys:thread</B> can be regarded as asynchronous <B>funcall</B>,
since <B>sys:thread</B> applies <EM>func to the spread list
of <EM>args but it does not accept the result of the
function application.
Rather, <B>sys:thread</B> returns the thread object assigned to
the funcall, so that the real result can be obtained later
by <B>sys:wait-thread</B>.
</UL>
<BLOCKQUOTE> <PRE>(defun compute-pi (digits) ...)
(setq trd (sys:thread \#'compute-pi 1000)) ;assign compute-pi to a thread
...  ;; other computation 
(sys:wait-thread trd) ;get the result of (compute-pi 1000)</PRE>
</BLOCKQUOTE>
<P>
<A NAME=12998>&#160;</A>
<B>sys:thread-no-wait</B> <EM>func &amp;rest args </EM>[function] 
<UL><LI> assigns computation to one of free threads.
The thread is reclaimed in the free thread pool when
it finishes evaluation without being <B>wait-thread</B>'ed.
</UL>
<A NAME=13009>&#160;</A>
<B>sys:wait-thread</B> <EM>thread </EM>[function] 
<UL><LI> waits for <EM>thread to finish evaluation of funcall given
by the <B>sys:thread</B> function, and retrieves the result
and returns it.
<B>Sys:wait-thread</B> is mandatory if the thread is assigned
evaluation by <B>sys:thread</B> because the thread is not returned
to the free thread pool until it finishes transferring the result.
</UL>
<A NAME=13023>&#160;</A>
<B>sys:plist</B> <EM>&amp;rest forms </EM>[macro] 
<UL><LI> evaluates <EM>forms by different
threads in parallel and waits for the completion of all evaluation,
and the list of results is returned.
<B>Sys:plist</B> may be regarded as <EM>parallel-list except that
each form listed must be a function call.
</UL>
</EM></EM></EM></EM></EM></EM></EM><HR><A NAME="tex2html3265" HREF="node102.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./icons/next_motif.gif"></A> <A NAME="tex2html3263" HREF="node88.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="./icons/up_motif.gif"></A> <A NAME="tex2html3257" HREF="node100.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="./icons/previous_motif.gif"></A> <A NAME="tex2html3267" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="./icons/contents_motif.gif"></A> <A NAME="tex2html3268" HREF="node153.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="./icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html3266" HREF="node102.html">Synchronization</A>
<B>Up:</B> <A NAME="tex2html3264" HREF="node88.html">Multithread</A>
<B> Previous:</B> <A NAME="tex2html3258" HREF="node100.html">Measured Parallel Gains</A>
<P><ADDRESS>
<I>Hirofumi Nakagaki <BR>
Tue Mar 19 19:45:39 JST 1996</I>
</ADDRESS>
</BODY>
</HTML>
