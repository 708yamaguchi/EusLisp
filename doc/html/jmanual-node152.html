<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//JP">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>多関節マニピュレータ</TITLE>
<META NAME="description" CONTENT="多関節マニピュレータ">
<META NAME="keywords" CONTENT="jmanual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="jmanual.css">

<LINK REL="previous" HREF="jmanual-node151.html">
<LINK REL="up" HREF="jmanual-node150.html">
<LINK REL="next" HREF="jmanual-node153.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html2672"
  HREF="jmanual-node153.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2666"
  HREF="jmanual-node150.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2662"
  HREF="jmanual-node151.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2668"
  HREF="jmanual-node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2670"
  HREF="jmanual-node156.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html2673"
  HREF="jmanual-node153.html">MARS: マルチ自律ロボットシミュレータ</A>
<B> Up:</B> <A NAME="tex2html2667"
  HREF="jmanual-node150.html">マニピュレータ</A>
<B> Previous:</B> <A NAME="tex2html2663"
  HREF="jmanual-node151.html">関節のモデル</A>
 &nbsp; <B>  <A NAME="tex2html2669"
  HREF="jmanual-node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html2671"
  HREF="jmanual-node156.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION04092000000000000000">

多関節マニピュレータ</A>
</H2>

<P>
マニピュレータモデルはクラス<B>manipulator</B>によって記述される。
マニピュレータモデルを作成するには、
次の<B>defmanipulator</B>マクロを用いる。

<P>

 <BR>
<BR> <A NAME="50898"></A>
<BR>
<IMG
 WIDTH="559" HEIGHT="130" ALIGN="BOTTOM" BORDER="0"
 SRC="jmanual-img106.png"
 ALT="\begin{emtabbing}
{\bf defmanipulator}
\it manipulator-name \&amp;key \= :class \hs...
...open-direction}\\
\&gt; :right-handed \&gt; {\it righty-or-lefty}
\rm
\end{emtabbing}">
<BR>

<DL COMPACT>
<DT> 
<DD>マニピュレータモデルを作成する。
</DD>
</DL>
<BR>
<BR>

<P>
	<BR> 
<A NAME="50921"></A>
<BIG CLASS="XLARGE"><B>rotational-joint </B></BIG> [クラス]  <PRE><TT>
  :super   <B>body</B> 
<BR>  :slots 		 (axis offset high-limit low-limit) 
</TT></PRE>
<BR>
<BR>

<DL COMPACT>
<DT> 
<DD>6自由度マニピュレータの間接を記述する。
</DD>
</DL>
<BR>
<BR>

<P>
	<BR> 
<A NAME="50939"></A>
<BIG CLASS="XLARGE"><B>manipulator </B></BIG> [クラス]  <PRE><TT>
  :super   <B>cascaded-coords</B> 
<BR>  :slots 		 (base baseinverse joint angles right-handed hand handcoords
<BR>
right-finger left-finger openvec max-span
<BR>
toolcoords toolinverse armsolcoords toolinverse armsocoords
<BR>
approach grasp affix) 
</TT></PRE>
<BR>
<BR>

<DL COMPACT>
<DT> 
<DD>ベースからハンドまでのマニピュレータの運動を管理する。
</DD>
</DL>
<BR>
<BR>

<P>

<A NAME="50956"></A>
<B>:newcoords</B> <EM>newrot &amp;optional newpos </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD>  
関節角度が限度に収まっていれば座標系を
<EM>newrot</EM>と<EM>newpos</EM>に更新する 

</DD>
</DL>
<BR>
<BR>

<A NAME="50968"></A>
<B>:armsolcoords </B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
ベース座標系からハンド座標系への変換（座標系のインスタンス）を計算し、作成する。

</DD>
</DL>
<BR>
<BR>

<A NAME="50978"></A>
<B>:tool</B> <EM>&amp;rest msg </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 工具座標系を返す、または変更する

</DD>
</DL>
<BR>
<BR>

<A NAME="50988"></A>
<B>:set-tool</B> <EM>newtool &amp;optional offset copy </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 工具座標系<TT>toolcoords</TT>に<EM>newtool</EM>を設定する

</DD>
</DL>
<BR>
<BR>

<A NAME="51000"></A>
<B>:reset-tool </B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 工具座標系を初期値に戻す

</DD>
</DL>
<BR>
<BR>

<A NAME="51010"></A>
<B>:worldcoords </B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 工具座標系の位置ベクトル、回転行列、座標系のワールド表現を求める

</DD>
</DL>
<BR>
<BR>

<A NAME="51020"></A>
<B>:set-coords </B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
順運動の解を求めるために、座標系を強制的に設定する。

</DD>
</DL>
<BR>
<BR>

<A NAME="51030"></A>
<B>:config </B> <EM>&amp;optional (a newangles) </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 6つの関節角度を直接に設定する

</DD>
</DL>
<BR>
<BR>

<A NAME="51040"></A>
<B>:park </B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 初期姿勢に戻す

</DD>
</DL>
<BR>
<BR>

<A NAME="51050"></A>
<B>:hand</B> <EM>&amp;optional (h nil) </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 ハンドオブジェクトを返す

</DD>
</DL>
<BR>
<BR>

<A NAME="51060"></A>
<B>:handcoords</B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 ハンド座標系の位置ベクトル、回転行列、座標系のワールド表現を求める

</DD>
</DL>
<BR>
<BR>

<A NAME="51070"></A>
<B>:span</B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 現在の指の間隔を返す

</DD>
</DL>
<BR>
<BR>

<A NAME="51080"></A>
<B>:open-fingers</B> <EM>s &amp;optional abs &amp;aux (current (send self :span)) </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 指幅を相対的、絶対的に指定する

</DD>
</DL>
<BR>
<BR>

<A NAME="51090"></A>
<B>:close-fingers</B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 指を完全に閉じる 

</DD>
</DL>
<BR>
<BR>

<A NAME="51100"></A>
<B>:angles</B> <EM>&amp;optional flag </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 現在の姿勢の関節角度のリストを返す

</DD>
</DL>
<BR>
<BR>

<P>

<A NAME="51110"></A>
<B>:get-approach </B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 現在アプローチしている対象を返す

</DD>
</DL>
<BR>
<BR>

<A NAME="51120"></A>
<B>:set-approach </B> <EM>a </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 アプローチ対象<I>a</I>を設定する

</DD>
</DL>
<BR>
<BR>

<A NAME="51131"></A>
<B>:set-grasp</B> <EM>g </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
 把握対象物<I>g</I>を指定する

</DD>
</DL>
<BR>
<BR>

<A NAME="51142"></A>
<B>:get-affix</B> [メソッド]

<DL COMPACT>
<DT> 
<DD> 
 把握している物体を返す

</DD>
</DL>
<BR>
<BR>

<A NAME="51152"></A>
<B>:affix</B> <EM>&amp;optional (grasp) </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
<B>affixed-object</B>に<TT>grasp</TT>を設定する。
<TT>grasp</TT>は、子孫として<TT>handcoords</TT>に関連付けられる。

</DD>
</DL>
<BR>
<BR>

<A NAME="51166"></A>
<B>:unfix</B> <EM>&amp;optional (margin 10.0) </EM>[メソッド]

<DL COMPACT>
<DT> 
<DD> 
<B>affixed-object</B>にNILを設定する。
<TT>grasp</TT>は、<TT>handcoords</TT>の子孫リストから外される。

</DD>
</DL>
<BR>
<BR>

<A NAME="51179"></A>
<BR>
<IMG
 WIDTH="710" HEIGHT="188" ALIGN="BOTTOM" BORDER="0"
 SRC="jmanual-img107.png"
 ALT="\begin{emtabbing}
{\bf :create}
\it\= \&amp;rest args \\lq  [メソッド]\\
\&gt; \&amp;key...
...fty lft) t)\\
\&gt; \&gt; ((:act a) nil)\\
\&gt; \&amp;allow-other-keys
\rm
\end{emtabbing}">
<BR>

<DL COMPACT>
<DT> 
<DD>新しいマニピュレータオブジェクトを作成、初期化する

</DD>
</DL>
<BR>
<BR>

             <P>
<B>manipulator</B>オブジェクトは、
<B>base、joints(J1...J6)、handcoords、toolcoords</B>
の座標系の繋がりを管理する。
<B>manipulator</B>クラスは、<B>cascaded-coords</B>のサブクラスであり、
やはり、<B>cascaded-coords</B>(または<B>body</B>などのサブクラス)
である<B>base</B>に結合され、
<B>base</B>から<B>toolcoords</B>(手先座標系)への変換を管理している。
したがって、<B>manipulator</B>オブジェクトに対して送られる
<B>:translate、:locate、:rotate、:orient、:transform</B>
などのメッセージは、手先点に対して作用する。
そのとき同時にWRTパラメータを指定すれば、
手先はWRT座標系に対して動く。
次のプログラムでは、<B>eta3</B>を<B>manipulator</B>のインスタンスと仮定している。

<P>
<PRE>
　(send eta3 :translate #f(0 0 -100))        ;手先を10cm引っ込める　
　(send eta3 :translate #f(0 0 -100) :world) ;10cm下げる
　(send eta3 :translate #f(0 0 -100)
             (manipulator-base eta3))     ;手先をベース座標系で10cm下げる
</PRE>

<P>
これらのメッセージに対して、manipulatorはアーム解を計算して6つの
関節角度を決定する。
一般に解は複数存在するが、<B>right-handed</B>(右手系、左手系)
の区別、および現在の関節角度との連続性により適当な解が選択される。
しかし、指定された位置、姿勢に対する解が存在しない場合や関節角が
限界を越える場合は移動、回転は起こらず、警告が発せられる。

<P>
アーム解の計算は、実際のマニピュレータに対応した
個々のmanipulatorクラスに定義された<B>:armsol</B>メソッドが行う。
マニピュレータがワールド座標系のどこに置かれてもよいように、
また、どのような工具を用いてもよいように、アーム解は、
<B>base、toolcoords</B>とは独立に、base座標系中でのハンドの位置、姿勢に
対して与えられる。

<P>
<B>base、J1、J2、...、handcoords、toolcoords</B>の関係を図<A HREF="#JointCoords"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>
に示す。
ワールドから手先への変換を<SPAN CLASS="MATH"><IMG
 WIDTH="553" HEIGHT="207" ALIGN="BOTTOM" BORDER="0"
 SRC="jmanual-img108.png"
 ALT="$T$"></SPAN>とすると、<SPAN CLASS="MATH"><IMG
 WIDTH="553" HEIGHT="207" ALIGN="BOTTOM" BORDER="0"
 SRC="jmanual-img108.png"
 ALT="$T$"></SPAN>および各部分変換は次のようにし
て得られる。

<P>
<!-- MATH
 $\begin{array}{ll}
T & = base \cdot J1 \cdot J2 \cdot \ldots
\cdot J6 \cdot handcoords \cdot toolcoords \\
 & = (send \; eta3 \; :worldcoords) \\
T_{Jn} & = base \cdot J1\cdot \ldots \cdot Jn \\
 & = (send \; Jn \; :worldcoords) \\
T_{arm} & = J1 \cdot J2 \cdot \ldots \cdot J6 \cdot handcoords \\
 & = (send \; eta3 \; :armsol-coords) \\
T_{tool} & = J1 \cdot J2 \cdot  \ldots \cdot J6 \cdot handcoords \cdot toolcoords \\
 & = (send \; eta3 \; :copy-coords) \\
T_{t} & = toolcoords \\
 & = (manipulator-toolcoords \; eta3)\\
T_{t}^{-1} & = toolcoords^{-1} \\
 & = (manipulator-toolinverse \; eta3) \\
T_{h} & = handcoords \\
 & = (manipulator-handcoords \; eta3)\\
\end{array}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="14" ALIGN="MIDDLE" BORDER="0"
 SRC="jmanual-img109.png"
 ALT="$
\begin{array}{ll}
T &amp; = base \cdot J1 \cdot J2 \cdot \ldots
\cdot J6 \cdot ha...
...
T_{h} &amp; = handcoords \\
&amp; = (manipulator-handcoords \; eta3)\\
\end{array}$"></SPAN>

<P>
ここで、<SPAN CLASS="MATH"><IMG
 WIDTH="553" HEIGHT="207" ALIGN="BOTTOM" BORDER="0"
 SRC="jmanual-img108.png"
 ALT="$T$"></SPAN>はワールド座標系から工具座標系まで変換する。

<P>

<DIV ALIGN="CENTER"><A NAME="JointCoords"></A><A NAME="50875"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure:</STRONG>
relation between coordinate systems in a manipulator</CAPTION>
<TR><TD><IMG
 WIDTH="415" HEIGHT="286" BORDER="0"
 SRC="jmanual-img110.png"
 ALT="\begin{figure}\begin{center}
\epsfile{file=fig/eta3coords.ps,height=100mm}
\end{center}
\par
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
各関節は、Brepで表現された幾何モデルを保持している。しかし、頂点の座標、
平面の方程式は常に現状を反映しているとは限らない。マニピュレータに対する
移動、回転などのメッセージでは座標系の更新だけを行い、頂点の座標は変化し
ない。これは、移動、回転が複数回続けて起こった場合の計算量を減らすためで
ある。更新は、マニピュレータに<B>:worldcoords</B>メッセージを送る
ことで引き起こされる。

<P>
マニピュレータは、手先座標系で動作を指定することを主な目的としている。
関節角による指定には <B>:config</B> を用いる。
引き数には6要素の列を与える。

<P>
<PRE>
　 (send eta3 :config (float-vector pi/2 pi/2 0 1 0 1))
</PRE>

<P>
<B>:config</B>は、各関節角度が可動範囲に収まっていることを検査した後、
それらを回転させる。
この結果、マニピュレータの管理している座標系と
関節角度から定まる実際の手先の位置姿勢とが一致しなくなる。
両者を一致させるためには、<B>:set-coords</B>メッセージを送る。
<B>:set-coords</B>は、関節角度から順方向のキネマティクスを計算し、
最終的な手先座標系に対してさらにアーム解を解く。

<P>
例 ETA3のモデル生成とその描画
<PRE>
EusLisp 7.27 with Xlib created on Thu Sep 17 14:33:30 1992
(load "view.l")                                ;ウィンドウを開く
(load "/usr/local/eus/robot/eta3/eta3build.l") ;ETA3のモデルを生成する
(send *viewing* :look #f(2000 2000 2000))      ;視点を変える
(send-all (eta3arm-components eta3) :color 1)  ;物体の線の色を黒に変える
(send eta3 :config (float-vector 0 (/ -Pi 4.0) Pi/2 0 (/ -Pi 4.0) 0 ))
					       ;ETA3を関節角度の指定で動かす
(send eta3 :set-coords)                        ;上記参照
(draw eta3)                                    ;ETA3を描画する
</PRE>

<P>


<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html2672"
  HREF="jmanual-node153.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2666"
  HREF="jmanual-node150.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2662"
  HREF="jmanual-node151.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2668"
  HREF="jmanual-node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2670"
  HREF="jmanual-node156.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html2673"
  HREF="jmanual-node153.html">MARS: マルチ自律ロボットシミュレータ</A>
<B> Up:</B> <A NAME="tex2html2667"
  HREF="jmanual-node150.html">マニピュレータ</A>
<B> Previous:</B> <A NAME="tex2html2663"
  HREF="jmanual-node151.html">関節のモデル</A>
 &nbsp; <B>  <A NAME="tex2html2669"
  HREF="jmanual-node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html2671"
  HREF="jmanual-node156.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
k-okada
2013-05-21
</ADDRESS>
</BODY>
</HTML>
